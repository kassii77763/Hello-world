# WriteWise RedPen Demo (日本語版)

WriteWise RedPen Demoは、AIを活用した文章校正機能と、ユニークな手書き風フィードバックインターフェースを提供する革新的なWebアプリケーションです。ユーザーはテキストを入力し、改善のための提案を受け取り、AIが生成した修正案を、視覚的に魅力的な「赤ペン」マークアップで体験しながら閲覧できます。

## 🌟 主な機能

*   **AIによるフィードバック**: GoogleのGemini APIを活用してテキストを分析し、洞察に満ちたフィードバックを提供します。
*   **カスタマイズ可能なフィードバック**: ユーザーはAIフィードバックの**目的**（例：一般的、SEO、学術的）と**トーン**（例：丁寧、単刀直入、批判的）を選択できます。
*   **インタラクティブな「赤ペン」UI**:
    *   **記事キャンバス**: AIが特定した問題箇所がハイライト（赤い波線）されてユーザーのテキストを表示します。
    *   **手書き風アノテーション**: 短い手書き風のコメントが余白に表示され、矢印でテキストと結び付けられます。
    *   **コメントサイドバー**: 特定された各問題点に対する詳細なフィードバックカード（原文、AIコメント、修正提案を含む）を表示します。
*   **リアルタイム設定更新**: フィードバックビューで目的やトーンを変更すると、新しい設定でテキストが即座に再分析されます。
*   **AI修正テキストビュー**: AIの提案をすべて適用した修正後のテキスト全体を表示する専用ビューで、ユーザーは完全に改訂されたバージョンを確認できます。
*   **複数ビュー**:
    *   **テキスト入力ビュー**: ユーザーがテキスト（最大10,000文字）を入力し、初期フィードバック設定を行うための広々としたエリア。
    *   **フィードバック結果ビュー**: 分析されたテキスト、アノテーション、詳細なコメントを閲覧するためのメインインターフェース。
    *   **AI修正テキストビュー**: AIの提案された修正を適用した後のテキストを表示します。
*   **レスポンシブデザイン**: 様々な画面サイズに適応し、良好なユーザーエクスペリエンスを提供します。
*   **ローディング＆エラーステート**: API呼び出し中や潜在的なエラーに対する明確な視覚的インジケータ。
*   **デモ用にAPIキー不要**: APIキーが提供されていない場合、アプリケーションはサンプルデータで動作します。

## 🛠️ 技術スタック

*   **フロントエンド**: React (esm.sh経由のES Modules使用), TypeScript
*   **スタイリング**: Tailwind CSS, Google Fonts (Noto Sans JP, Patrick Hand)
*   **AI**: Google Gemini API (`gemini-2.5-flash-preview-04-17`)
*   **グラフィック**: アノテーションや矢印の描画にSVGを使用。

## 🚀 セットアップと実行方法

このアプリケーションは、最新のブラウザのES Moduleサポートを使用して、`index.html`から直接実行するように設計されています。

**前提条件**:
*   最新のウェブブラウザ（例：Chrome, Firefox, Edge, Safari）。
*   インターネット接続（ESモジュールの読み込み、および設定されている場合はGemini APIの使用のため）。

**アプリケーションの実行**:
1.  **コードの入手**: プロジェクトファイル一式（`index.html`, `index.tsx`, `App.tsx`、および`components/`, `views/`, `services/`, `constants/`, `types/`内のすべてのファイル）があることを確認してください。
2.  **APIキー（オプションですが全機能利用に推奨）**:
    *   ライブのGoogle Gemini APIを使用するには、APIキーが必要です。
    *   アプリケーションは、`geminiService.ts`が実行される実行コンテキスト内で`API_KEY`という名前の環境変数としてAPIキーが利用可能であることを期待しています。**このアプリケーション自体は、ブラウザで直接APIキーを入力または保存する方法を提供していません。**
    *   `process.env.API_KEY`が設定されていないかアクセスできない場合、アプリケーションは自動的にモック/サンプルフィードバックデータを使用するようにフォールバックします。
3.  **ファイルの提供**:
    *   ES Moduleのセキュリティ制限（CORS）のため、ファイルシステムから直接`index.html`を開く（`file:///`）のではなく、`index.html`と他のアセットを正しく提供するために簡単なHTTPサーバーが必要です。
    *   簡単な方法の一つは`npx serve`を使用することです:
        ```bash
        npx serve .
        ```
        その後、サーバーから提供されるURL（通常は `http://localhost:3000` または `http://localhost:5000`）を開きます。
    *   または、Pythonがインストールされている場合:
        ```bash
        python -m http.server
        ```
        その後、`http://localhost:8000`を開きます。
    *   多くのコードエディタ（VS Codeの「Live Server」拡張機能など）も、ローカルHTMLファイルを簡単に提供する方法を提供しています。

## 📂 プロジェクト構造

```
.
├── README.md                 # このファイル (日本語版は翻訳されたもの)
├── index.html                # メインHTMLエントリポイント
├── index.tsx                 # Reactルートレンダリング
├── metadata.json             # アプリケーションメタデータ
├── App.tsx                   # メインアプリケーションコンポーネント、状態管理、ルーティング
├── constants.ts              # グローバル定数 (APIモデル, デフォルトテキスト, 設定オプション)
├── types.ts                  # TypeScript型定義
├── components/               # 再利用可能なUIコンポーネント
│   ├── ArticleCanvas.tsx     # ハイライトとSVGアノテーション付きでテキストを表示
│   ├── CommentCard.tsx       # 個別フィードバック項目カード
│   ├── CommentSidebar.tsx    # 全フィードバックカード表示用サイドバー
│   ├── ErrorDisplay.tsx      # エラーメッセージ表示用コンポーネント
│   ├── FeedbackSettingsControls.tsx # フィードバックビューで目的/トーン変更用UI
│   ├── HandwrittenAnnotation.tsx # 余白の手書き風短いメモ
│   └── LoadingIcon.tsx       # アニメーション付きローディングスピナー
├── services/                 # サービス (例: API通信)
│   └── geminiService.ts      # Google Gemini APIとの対話を処理
└── views/                    # トップレベルビューコンポーネント (画面)
    ├── AiCorrectedTextView.tsx # AI適用修正ビュー
    ├── FeedbackView.tsx      # フィードバック結果表示ビュー
    └── InputView.tsx         # テキスト入力と初期設定ビュー
```

## 📖 使用方法

1.  **アプリケーションへのアクセス**: 提供された`index.html`をブラウザで開きます。
2.  **テキスト入力タブ**:
    *   分析したいテキストを大きなテキストエリアに入力または貼り付けます。
    *   フィードバックの「目的」と「トーン」を選択します。
    *   「Get Feedback」ボタンをクリックします。
3.  **フィードバック結果タブ**:
    *   フィードバックが取得されると、アプリケーションはこのタブに自動的に切り替わります。
    *   左側（`ArticleCanvas`）に、ハイライトと余白の手書き風アノテーション付きでテキストが表示されます。
    *   右側のサイドバー（`CommentSidebar`）には、詳細なフィードバックカードが表示されます。カードをクリックすると関連するテキストにスクロールし、その逆も同様です。
    *   このビューで「目的」と「トーン」の設定を直接変更して、新しいパラメータでテキストを再分析できます。
4.  **AI修正テキストタブ**:
    *   このタブに切り替えると、AIの提案がすべて適用された元のテキストが表示され、完全に改訂されたバージョンが提供されます。
5.  **ナビゲーション**: ヘッダーのタブ（「テキスト入力」、「フィードバック結果」、「AI修正案」）を使用してビューを切り替えます。フィードバックと修正テキストのタブは、最初のフィードバックが生成されるまで無効になっています。

## 🔑 APIキーについて

*   このアプリケーションは、Gemini APIキーを`process.env.API_KEY`から取得するように設計されています。
*   **アプリケーションは、UIを通じてAPIキーを要求、保存、または管理しません。**
*   環境内でAPIキーが見つからない場合、アプリケーションは優雅にフォールバックし、定義済みのサンプルフィードバックデータを使用します。これにより、ライブAPI接続なしでUIと機能を試すことができます。

## 💡 既知の考慮事項

*   **パフォーマンス**: 非常に長いテキスト（10,000文字の制限に近い）でフィードバック項目が密集している場合、多数のDOM要素とSVG計算により、レンダリングに遅延が発生する可能性があります。
*   **AI出力品質**: フィードバックと提案の品質と精度は、基盤となるAIモデル（Gemini）とプロンプトの明確さに大きく依存します。`geminiService.ts`内の現在のプロンプトはAIをガイドするように設計されていますが、結果は異なる場合があります。
*   **修正テキストの重複処理**: `AiCorrectedTextView.tsx`の`generateCorrectedText`関数は、重複する`target_text`セグメントを処理するために、最初に出現するまたは最も長いセグメントを優先する貪欲なアプローチを使用します。複雑なケースでは、より高度な重複解決が必要になる場合があります。
*   **インターネット依存**: 初期ライブラリの読み込み（esm.shから）およびAPIキーが設定されている場合のAPI呼び出しには、インターネット接続が必要です。


このREADMEは、WriteWise RedPen Demoアプリケーションの概要を提供します。機能の探索をお楽しみください！
